<!doctype html>
<html lang="en" data-theme="light">
  <head>
    <link type="application/atom+xml" rel="alternate" href="/feed.xml" title="James Garcia" />
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>How to dismiss flash messages with Rails turbo | James Garcia</title>

<meta name="description" content="James Garcia - Web developer" />

<link rel="stylesheet" href="/_bridgetown/static/css/main.c4aa4b876deed32762e8.css" />
<script src="/_bridgetown/static/js/main.3e63050e6041267a18e4.js" defer></script>
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

  </head>
  <body class="post ">
    <div class="navbar bg-amber-300 font-medium">
  <div class="navbar-start">
    <div class="dropdown">
      <label tabindex="0" class="btn btn-ghost lg:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" /></svg>
      </label>
      <ul tabindex="0" class="menu menu-compact dropdown-content mt-3 p-2 shadow bg-base-100 rounded-box w-52">
        <li>
          <a class="navbar-item" href="/">
            Home
          </a>
        </li>
        <li>
          <a class="navbar-item" href="/about">
            About
          </a>
        </li>
        <li>
          <a class="navbar-item" href="/posts">
            Posts
          </a>
        </li>
        <li>
          <a class="navbar-item" href="/projects">
            Projects
          </a>
        </li>
      </ul>
    </div>
  </div>
  <div class="navbar-center hidden lg:flex">
    <ul class="menu menu-horizontal px-1">
      <li>
        <a class="navbar-item" href="/">
          Home
        </a>
      </li>
      <li>
        <a class="navbar-item" href="/about">
          About
        </a>
      </li>
      <li>
        <a class="navbar-item" href="/posts">
          Posts
        </a>
      </li>
      <li>
        <a class="navbar-item" href="/projects">
          Projects
        </a>
      </li>
    </ul>
  </div>
  <div class="navbar-end"></div>
</div>


    <main>
      <article class="mt-20 mx-auto w-full max-w-2xl prose lg:prose-xl">
  <h1 class="my-8 text-center text-4xl font-bold text-gray-800 tracking-tight leading-none md:text-5xl xl:text-6xl">
  How to dismiss flash messages with Rails turbo
  </h1>

  <section class="md:px-0 px-4">
    <div class="mb-4">
        <div class="text-xl font-bold text-gray-900 ">
          James Garcia
        </div>
      <div class="text-base font-light text-gray-500">
        2022-07-11
      </div>

    </div>
    <div class="">
      <p>In the past I have added JavaScript or CSS to dismiss or hide Flash messages. I wanted to do the same using the new Rails Turbo. So this is what I came up with. I created a gist which can be found <a href="https://gist.github.com/jamgar/a4f1378fce74e9fd85029550730030e1">here</a></p>

<p>My setup:</p>
<ul>
  <li>Ruby 3.1.2</li>
  <li>Rails 7.0.3</li>
  <li>Tailwind for CSS</li>
</ul>

<p>I am assuming that you know how to create a new Rails app. I then scaffolded Notes with title and body to have a resource to work with.</p>

<p>In the application.html.erb before <code class="highlighter-rouge">yield</code> I added the div with the id of “flash-messages” which will be used to target on the dismiss.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/views/layouts/application.html.erb</span>
  <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">main</span> <span class="k">class</span><span class="o">=</span><span class="s2">"container mx-auto mt-28 px-5"</span><span class="o">&gt;</span>
      <span class="o">&lt;!--</span> <span class="no">ADD</span> <span class="no">THESE</span> <span class="no">LINES</span> <span class="o">--&gt;</span>
      <span class="o">&lt;</span><span class="n">div</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"flash-messages"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="sx">%= render "shared/flash_messages" %&gt;
      &lt;/div&gt;
       &lt;!-- END OF LINES --&gt;
      &lt;%=</span> <span class="k">yield</span> <span class="sx">%&gt;
    &lt;/main&gt;</span>
  <span class="o">&lt;</span><span class="sr">/body&gt;
</span></code></pre></div></div>

<p>Next we create the partial. This will contain the Dismiss button. The button_to makes a post request to flash_path, which will create later. You may be wondering why a <code class="highlighter-rouge">post</code> request that is because the button_to creates a form, which is the default method on a form. Trying to change that to a get or delete will cause you some headaches.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/views/shared/_flash_messages.html.erb</span>

<span class="o">&lt;</span><span class="sx">% flash.each </span><span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">msg</span><span class="o">|</span> <span class="sx">%&gt;
  &lt;div class="flex justify-between p-4 mb-4 bg-blue-100 border-t-4 border-blue-500 dark:bg-blue-200" role="alert"&gt;</span>
    <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">"flex"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">svg</span> <span class="k">class</span><span class="o">=</span><span class="s2">"flex-shrink-0 w-5 h-5 text-blue-700"</span> <span class="n">fill</span><span class="o">=</span><span class="s2">"currentColor"</span> <span class="n">viewBox</span><span class="o">=</span><span class="s2">"0 0 20 20"</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">"http://www.w3.org/2000/svg"</span><span class="o">&gt;&lt;</span><span class="n">path</span> <span class="n">fill</span><span class="o">-</span><span class="n">rule</span><span class="o">=</span><span class="s2">"evenodd"</span> <span class="n">d</span><span class="o">=</span><span class="s2">"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"</span> <span class="n">clip</span><span class="o">-</span><span class="n">rule</span><span class="o">=</span><span class="s2">"evenodd"</span><span class="o">&gt;&lt;</span><span class="sr">/path&gt;&lt;/s</span><span class="n">vg</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">"ml-3 text-sm font-medium text-blue-700"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="sx">%= msg %&gt;
      &lt;/div&gt;
    &lt;/div&gt;
# This is the Dismiss button
    &lt;%=</span> <span class="n">button_to</span> <span class="n">flash_path</span><span class="p">,</span> <span class="ss">class: </span><span class="s2">" -mx-1.5 -my-1.5 bg-blue-100 dark:bg-blue-200 text-blue-500 rounded-lg focus:ring-2 focus:ring-blue-400 p-1.5 hover:bg-blue-200 dark:hover:bg-blue-300 inline-flex h-8 w-8"</span> <span class="k">do</span> <span class="sx">%&gt;
      &lt;span class="sr-only"&gt;</span><span class="no">Dismiss</span><span class="o">&lt;</span><span class="sr">/span&gt;
      &lt;svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http:/</span><span class="o">/</span><span class="n">www</span><span class="p">.</span><span class="nf">w3</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="mi">2000</span><span class="o">/</span><span class="n">svg</span><span class="s2">"&gt;&lt;path fill-rule="</span><span class="n">evenodd</span><span class="s2">" d="</span><span class="no">M4</span><span class="o">.</span><span class="mi">293</span> <span class="mf">4.293</span><span class="n">a1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mo">011</span><span class="o">.</span><span class="mi">414</span> <span class="mi">0</span><span class="no">L10</span> <span class="mf">8.586</span><span class="n">l4</span><span class="o">.</span><span class="mi">293</span><span class="o">-</span><span class="mf">4.293</span><span class="n">a1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mf">111.414</span> <span class="mf">1.414</span><span class="no">L11</span><span class="o">.</span><span class="mi">414</span> <span class="mi">10</span><span class="n">l4</span><span class="o">.</span><span class="mi">293</span> <span class="mf">4.293</span><span class="n">a1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mo">01</span><span class="o">-</span><span class="mf">1.414</span> <span class="mf">1.414</span><span class="no">L10</span> <span class="mf">11.414</span><span class="n">l</span><span class="o">-</span><span class="mf">4.293</span> <span class="mf">4.293</span><span class="n">a1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mo">01</span><span class="o">-</span><span class="mf">1.414</span><span class="o">-</span><span class="mf">1.414</span><span class="no">L8</span><span class="o">.</span><span class="mi">586</span> <span class="mi">10</span> <span class="mf">4.293</span> <span class="mf">5.707</span><span class="n">a1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mo">010</span><span class="o">-</span><span class="mf">1.414</span><span class="n">z</span><span class="s2">" clip-rule="</span><span class="n">evenodd</span><span class="s2">"&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;% end %&gt;
# End of button
  &lt;/div&gt;
&lt;% end %&gt;
</span></code></pre></div></div>

<p>Create the Flash controller with a Dismiss action. The <code class="highlighter-rouge">flash.clear</code> will clear any flash messages so that there will not be any to display or loop through.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/controllers/flash_controller.rb</span>

<span class="k">class</span> <span class="nc">FlashController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">dismiss</span>
    <span class="n">flash</span><span class="p">.</span><span class="nf">clear</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Next create the turbo_stream view for the dismiss. When we submit the form that the button_to created it will send in the format of TURBO_STREAM, which will cause the dismiss action to respond_to a turbo_stream view. The view is updating the partial flash_message, and since we cleared the flash it will display an empty div.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># app/views/flash/dismiss.turbo_stream.erb</span>

<span class="o">&lt;</span><span class="sx">%= turbo_stream.update "flash-messages", partial: "shared/flash_messages" %&gt;
</span></code></pre></div></div>

<p>Finally we will create the route for the dismiss button.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/routes.rb</span>

<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>

  <span class="n">post</span> <span class="s1">'flash'</span><span class="p">,</span> <span class="ss">to: </span><span class="s1">'flash#dismiss'</span>

<span class="k">end</span>
</code></pre></div></div>

<p>This may or may not be less code, but it was something I wanted to see how to accomplish. I hope this was helpful if you are trying to use as much of Rails as possible. Happy coding.</p>

    </div>
  </section>
</article>


    </main>

    <footer class="footer footer-center p-10 bg-gray-600 text-white rounded">
  <div class="grid grid-flow-col gap-4">
    <a class="link link-hover">About</a> 
    <a class="link link-hover">Post</a> 
    <a class="link link-hover">Projects</a> 
  </div> 
  <div>
    <div class="grid grid-flow-col gap-4">
      <span>
        <a href="https://github.com/jamgar">GitHub</a>
      </span>
    </div>
  </div> 
  <div>
    <p>Copyright © 2022 - All right reserved by James Garcia</p>
  </div>
</footer>

  </body>
</html>
